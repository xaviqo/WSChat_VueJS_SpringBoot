(function(){"use strict";var t={5825:function(t,e,s){s.d(e,{N:function(){return te}});var a=s(144),o=s(9955),r=s(1096),n=s(3551),i=function(){var t=this,e=t._self._c;return e(r.Z,[e("ChatHeader"),e(o.Z,{staticStyle:{position:"absolute",right:"5%",top:"5%","z-index":"20001"},attrs:{border:"bottom",dismissible:"","colored-border":"",type:t.alert.type,color:t.alert.color,elevation:"4",width:"20%",transition:"slide-y-transition"},model:{value:t.alert.show,callback:function(e){t.$set(t.alert,"show",e)},expression:"alert.show"}},[t._v(" "+t._s(t.alert.message)+" ")]),e(n.Z,{staticClass:"fill-height background"},[e("router-view")],1)],1)},c=[],l=s(9203),m=s(7179),d=s(5057),u=s(5234),h=s(2370),g=function(){var t=this,e=t._self._c;return e(l.Z,{staticClass:"slight-opacity",attrs:{app:"",elevation:"0"}},[e("div",[e("h1",[e(d.Z,{staticClass:"mr-2",attrs:{"x-large":"",color:"black"}},[t._v("mdi-forum-outline")]),e("span",{staticClass:"grey--text text--darken-2 font-weight-medium"},[t._v("free")]),e("span",{staticClass:"grey--text text--darken-3 font-weight-bold"},[t._v("fast")]),e("span",{staticClass:"grey--text text--darken-4 font-weight-black"},[t._v("chat")])],1)]),e(u.Z),t._l(t.menu,(function(s,a){return e(h.lj,{key:"tb_"+a,attrs:{app:""}},[e(m.Z,{attrs:{text:""}},[e(d.Z,{attrs:{small:""}},[t._v(" "+t._s(s.icon)+" ")]),t._v(" "+t._s(s.title)+" ")],1)],1)}))],2)},p=[],f={name:"ChatHeader",data:()=>({menu:[{title:"create room",icon:"mdi-plus",link:"/create"},{title:"join room",icon:"mdi-chat-plus-outline",link:"/join"},{title:"source code",icon:"mdi-github",link:"/code"},{title:"xavi.tech",icon:"mdi-code-braces",link:"/xavitech"}]})},v=f,y=s(1001),S=(0,y.Z)(v,g,p,!1,null,null,null),Z=S.exports,C={name:"App",components:{ChatHeader:Z},created(){te.$on("showAlert",(t=>{this.showAlert(t)}))},data:()=>({alert:{message:null,type:null,color:null,show:!1}}),methods:{showAlert(t){this.alert={color:t.color,type:t.type,message:t.msg,show:!0},setTimeout((()=>this.alert.show=!1),2200)}}},k=C,R=(0,y.Z)(k,i,c,!1,null,null,null),b=R.exports,I=s(8345),_=s(4437),A=s(6035),x=s(5294),w=function(){var t=this,e=t._self._c;return e(A.Z,{staticClass:"fill-height"},[e(x.Z,[e(_.Z,[e(x.Z,{staticClass:"d-flex justify-center align-center"},[e("NewRoomCard")],1)],1)],1)],1)},M=[],U=s(8819),$=s(3058),j=s(1313),E=s(2469),T=s(6275),N=s(2528),O=s(5251),q=s(5838),P=function(){var t=this,e=t._self._c;return e(x.Z,{staticClass:"d-flex justify-center align-center fill-height"},[[e($.Z,{staticClass:"slight-opacity mb-16",attrs:{elevation:"1",outlined:"","max-width":"800px"}},[e(q.Z,{staticClass:"pa-2",attrs:{color:"transparent",elevation:"0"}},[e(d.Z,{staticClass:"mr-5"},[t._v("mdi-tune-variant")]),e(h.qW,{staticClass:"text-h5 text-cap"},[t._v(" Create a new chat room ")])],1),e(x.Z,{staticClass:"pa-10"},[e(_.Z,{attrs:{cols:"5"}},[e(O.Z,{attrs:{label:"Room name/topic",filled:"",dense:""},model:{value:t.createRoomReq.topic,callback:function(e){t.$set(t.createRoomReq,"topic",e)},expression:"createRoomReq.topic"}})],1),e(_.Z,{attrs:{cols:"4"}},[e(O.Z,{attrs:{label:"Nickname",filled:"",dense:"",rules:[t.nicknameRules.minl,t.nicknameRules.maxl]},model:{value:t.createRoomReq.nickname,callback:function(e){t.$set(t.createRoomReq,"nickname",e)},expression:"createRoomReq.nickname"}})],1),e(_.Z,{staticClass:"d-flex justify-space-around",attrs:{cols:"3"}},[e(U.Z,{staticClass:"avatar-bg-style",attrs:{size:"56"}},[t.createRoomReq.nickname.length<6?e(d.Z,{attrs:{"x-large":""}},[t._v(" mdi-help-circle-outline ")]):e(E.Z,{attrs:{src:t.pickedAvatar()},scopedSlots:t._u([{key:"placeholder",fn:function(){return[e(x.Z,{staticClass:"fill-height ma-0",attrs:{align:"center",justify:"center"}},[e(T.Z,{attrs:{indeterminate:"",color:"grey lighten-5"}})],1)]},proxy:!0}])})],1),e(U.Z,{staticClass:"avatar-bg-style",attrs:{size:"56"}},[e(m.Z,{attrs:{color:"grey-darken-4",large:"",elevation:"0",icon:""},on:{click:t.randomAvatar}},[e(d.Z,[t._v(" mdi-dice-5-outline ")])],1)],1)],1),e(_.Z,{attrs:{cols:"4"}},[e(N.Z,{attrs:{items:t.getRoomCapacitySelect,label:"Room capacity",filled:""},model:{value:t.createRoomReq.roomCapacity,callback:function(e){t.$set(t.createRoomReq,"roomCapacity",e)},expression:"createRoomReq.roomCapacity"}})],1),e(_.Z,{staticClass:"d-flex justify-center",attrs:{cols:"4"}},[e("div",{staticClass:"mt-n1"},[e(j.Z,{attrs:{label:"Password protected",filled:""}})],1)]),e(_.Z,{staticClass:"d-flex justify-center",attrs:{cols:"4"}},[e("div",{staticClass:"mt-n1"},[e(j.Z,{attrs:{label:"Show in explorer",filled:""}})],1)]),e(_.Z,{staticClass:"d-flex justify-center"},[e(m.Z,{staticClass:"mt-n5",staticStyle:{border:"rgba(128,128,128,.3) 1px solid !important","background-color":"rgba(255,255,255,.3) !important"},attrs:{elevation:"2","x-large":""},on:{click:function(e){return t.createNewRoom()}}},[e(d.Z,{staticClass:"mr-1"},[t._v(" mdi-plus ")]),t._v(" Create room ")],1)],1)],1)],1)]],2)},L=[];s(7658);const V={methods:{avatarURL:(t,e)=>`https://avatars.dicebear.com/api/${t.toLowerCase()}/${e}.svg`,randomizeStyle:(t,e)=>{const s=t.length;let a;if(s>0)do{const e=Math.floor(s*Math.random());a=t[e]}while(a===e);return a}}};var D=s(629),z={name:"NewRoomCard",mixins:[V],data:()=>({createRoomReq:{topic:"",nickname:"",avatarStyle:null,roomCapacity:2},nicknameRules:{minl:t=>t.length>=6||"Min 6 characters",maxl:t=>t.length<=14||"Max 6 characters"}}),created(){this.$store.dispatch("appSettingsModule/loadAppSettings")},computed:{...(0,D.Se)("appSettingsModule",["getRoomCapacitySelect"]),...(0,D.Se)("appSettingsModule",["getAvailableAvatars"])},methods:{pickedAvatar(){return this.createRoomReq.avatarStyle||this.randomAvatar(),this.avatarURL(this.createRoomReq.avatarStyle,this.createRoomReq.nickname)},randomAvatar(){this.createRoomReq.avatarStyle=this.randomizeStyle(this.getAvailableAvatars,this.createRoomReq.avatarStyle)},createNewRoom(){this.axios.post("/chat/create",this.createRoomReq).then((t=>{te.$emit("showAlert",{color:"success",type:"success",msg:`Room ${t.data.roomTopic} successfully created`}),this.$store.dispatch("userStorageModule/disconnectUser"),this.$store.dispatch("userStorageModule/setUserStorageAction",t.data),this.$router.push(`/chat/${t.data.chatId}`)}))}}},B=z,K=(0,y.Z)(B,P,L,!1,null,"594d4b80",null),W=K.exports,J={name:"HomeView",components:{NewRoomCard:W}},H=J,G=(0,y.Z)(H,w,M,!1,null,null,null),Y=G.exports,F=s(9868),Q=function(){var t=this,e=t._self._c;return e(A.Z,{staticClass:"py-0 fill-height"},[e(x.Z,{attrs:{lass:"slight-opacity"}},[e(_.Z,{attrs:{cols:"2"}},[e("ChatUsers",{attrs:{"room-id":t.gettersVuex.roomId}})],1),e(_.Z,[e(F.Z,{attrs:{"min-height":"90vh",rounded:"lg"}},[e(_.Z,{staticStyle:{height:"82vh"},attrs:{cols:"12"}},[e("ChatMessages")],1),e(_.Z,{staticStyle:{height:"8vh"},attrs:{cols:"12"}},[e("ChatInput")],1)],1)],1)],1)],1)},X=[],tt=s(5132),et=s(4192),st=s(248),at=s(1908),ot=s(7679),rt=function(){var t=this,e=t._self._c;return e(F.Z,{attrs:{rounded:"lg"}},[e(q.Z,{staticClass:"greyish-element",attrs:{elevation:"0"}},[e(h.qW,[e(d.Z,[t._v("mdi-account")]),e("span",[t._v(" Users ")])],1),e(u.Z),e(m.Z,{attrs:{icon:""}},[e(d.Z,[t._v(" mdi-plus-thick ")])],1)],1),e(st.Z,{attrs:{color:"transparent"}},[t._l(t.onlineUsers,(function(s){return e(at.Z,{key:s.id,attrs:{link:""}},[e(ot.km,[e(ot.V9,[e(tt.Z,{staticClass:"mt-1",attrs:{bordered:"",bottom:"",color:"green accent-4",dot:"","offset-x":"10","offset-y":"10"}},[e(U.Z,{staticClass:"avatar-bg-style",attrs:{size:"32"}},[e(E.Z,{attrs:{src:t.avatarURL(s.avatar,s.nickname)},scopedSlots:t._u([{key:"placeholder",fn:function(){return[e(x.Z,{staticClass:"fill-height ma-0",attrs:{align:"center",justify:"center"}},[e(T.Z,{attrs:{indeterminate:"",color:"grey lighten-5"}})],1)]},proxy:!0}],null,!0)})],1)],1),e("span",{staticClass:"ml-2"},[t._v(t._s(s.nickname))])],1)],1)],1)})),t.offlineUsers.length>0?e(et.Z,{staticClass:"my-2"}):t._e(),t._l(t.offlineUsers,(function(s){return e(at.Z,{key:s.id,attrs:{link:""}},[e(ot.km,[e(ot.V9,[e(tt.Z,{staticClass:"mt-1",attrs:{bordered:"",bottom:"",color:"red accent-4",dot:"","offset-x":"10","offset-y":"10"}},[e(U.Z,{staticClass:"avatar-bg-style",attrs:{size:"32"}},[e(E.Z,{attrs:{src:t.avatarURL(s.avatar,s.nickname)},scopedSlots:t._u([{key:"placeholder",fn:function(){return[e(x.Z,{staticClass:"fill-height ma-0",attrs:{align:"center",justify:"center"}},[e(T.Z,{attrs:{indeterminate:"",color:"grey lighten-5"}})],1)]},proxy:!0}],null,!0)})],1)],1),e("span",{staticClass:"ml-2"},[t._v(t._s(s.nickname))])],1)],1)],1)}))],2)],1)},nt=[],it={name:"ChatUsers",mixins:[V],data:()=>({}),created(){},methods:{},computed:{onlineUsers(){return this.getUsers.filter((t=>t.connected))},offlineUsers(){return this.getUsers.filter((t=>!t.connected))},...(0,D.Se)("webSocketModule",["getUsers"])}},ct=it,lt=(0,y.Z)(ct,rt,nt,!1,null,"21f564c0",null),mt=lt.exports,dt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"greyish-element",staticStyle:{height:"6vh"},attrs:{id:"chat-msg-input"}},[e(O.Z,{attrs:{color:"gray","append-outer-icon":"mdi-send",outlined:""},on:{"click:append-outer":function(e){return t.sendMessage(t.inputMessage)},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendMessage(t.inputMessage)}},model:{value:t.inputMessage,callback:function(e){t.inputMessage=e},expression:"inputMessage"}})],1)},ut=[],ht={name:"ChatInput",data:()=>({inputMessage:""}),methods:{sendMessage(t){this.$store.dispatch("webSocketModule/sendMessage",t),this.inputMessage=""}}},gt=ht,pt=(0,y.Z)(gt,dt,ut,!1,null,"3d64d56d",null),ft=pt.exports,vt=s(5223),yt=s(4944),St=s(4831),Zt=function(){var t=this,e=t._self._c;return e($.Z,{staticClass:"fill-height greyish-element",attrs:{flat:""}},[e(q.Z,{staticClass:"greyish-element mt-n2",attrs:{elevation:"0"}},[e(h.qW,[e(d.Z,[t._v(" mdi-forum ")]),t._v(" "+t._s("Room Topic")+" ")],1),e(u.Z),e(m.Z,{attrs:{icon:""}},[e(d.Z,[t._v(" mdi-cog ")])],1)],1),e(vt.ZB,{staticClass:"overflow-y-auto",staticStyle:{"max-height":"71vh"}},[t._l(t.getMessages,(function(s){return[e("div",{key:s.message,class:{"d-flex flex-row-reverse":t.itsMe(s.userId)}},[e(St.Z,{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function({on:a}){return[e(yt.Z,t._g({staticClass:"pa-4 mb-2",staticStyle:{height:"auto","white-space":"normal"},attrs:{color:t.itsMe(s.userId)?"primary":"",dark:""}},a),[t._v(" "+t._s(s.message)+" "),e(U.Z,{staticClass:"avatar-bg-style mx-2",attrs:{size:"32",color:"white"}},[e(E.Z,{attrs:{src:t.avatarURL(t.getAvatarById(s.userId),t.getNicknameById(s.userId))},scopedSlots:t._u([{key:"placeholder",fn:function(){return[e(x.Z,{staticClass:"fill-height ma-0",attrs:{align:"center",justify:"center"}},[e(T.Z,{attrs:{indeterminate:"",color:"grey lighten-5",size:"32px"}})],1)]},proxy:!0}],null,!0)})],1)],1)]}}],null,!0)},[e(st.Z,[e(at.Z,[e(ot.km,[e(ot.V9,[t._v(t._s(t.getNicknameById(s.userId)))]),e(ot.oZ,[t._v("Nickname")])],1)],1),e(at.Z,[e(ot.km,[e(ot.V9,[t._v(t._s(t.formatedSentDate(s.sentDate)))]),e(ot.oZ,[t._v("Sent Date")])],1)],1)],1)],1)],1)]}))],2)],1)},Ct=[],kt={name:"ChatMessages",mixins:[V],computed:{...(0,D.Se)("userStorageModule",["getUserId"]),...(0,D.Se)("webSocketModule",["getMessages"])},methods:{itsMe(t){return this.getUserId===t},getAvatarById(t){const e=this.$store.getters["webSocketModule/getUserById"](t);return e?e.avatar:"Usuario no encontrado"},getNicknameById(t){const e=this.$store.getters["webSocketModule/getUserById"](t);return e?e.nickname:"Usuario no encontrado"},formatedSentDate(t){const e=new Date(t);return`${e.toLocaleTimeString()} - ${e.toLocaleDateString()}`}},data:()=>({})},Rt=kt,bt=(0,y.Z)(Rt,Zt,Ct,!1,null,"0fabc6c2",null),It=bt.exports,_t={name:"ChatRoomView",components:{ChatMessages:It,ChatInput:ft,ChatUsers:mt},data:()=>({room:{id:0},user:{id:0,nickname:"",accessToken:""},gettersVuex:{isConnected:!1,chatId:""}}),created(){this.gettersVuex.isConnected=this.$store.getters["userStorageModule/isUserConnected"],this.gettersVuex.chatId=this.$store.getters["userStorageModule/getChatId"],this.setRoomAndUserData(),this.$store.dispatch("webSocketModule/connectWS",{senderId:this.user.id,token:this.user.accessToken,senderName:this.user.nickname,roomId:this.room.id})},methods:{setRoomAndUserData(){this.room.id=this.$route.params.roomId,this.user.id=this.$store.getters["userStorageModule/getUserId"],this.user.nickname=this.$store.getters["userStorageModule/getUserNickname"],this.user.accessToken=this.$store.getters["userStorageModule/getAccessToken"]}}},At=_t,xt=(0,y.Z)(At,Q,X,!1,null,null,null),wt=xt.exports,Mt=function(){var t=this,e=t._self._c;return e(x.Z,{staticClass:"d-flex justify-center align-center fill-height"},[e($.Z,{staticClass:"slight-opacity mb-16",attrs:{elevation:"1",outlined:"","min-width":"40vw"}},[e(q.Z,{staticClass:"pa-2",attrs:{color:"transparent",elevation:"0"}},[e(d.Z,{staticClass:"mr-5"},[t._v("mdi-chat-plus")]),e(h.qW,{staticClass:"text-h5 text-cap"},[t._v(" Join room: "+t._s(t.room.roomName)+" #"+t._s(t.room.roomId)+" ")])],1),e(x.Z,{staticClass:"pa-10"},[e(_.Z,{attrs:{cols:"9"}},[e(O.Z,{attrs:{label:"Nickname",filled:"",dense:"",rules:[t.nicknameRules.minl,t.nicknameRules.maxl]},model:{value:t.joinReq.nickname,callback:function(e){t.$set(t.joinReq,"nickname",e)},expression:"joinReq.nickname"}})],1),e(_.Z,{staticClass:"d-flex justify-space-around",attrs:{cols:"3"}},[e(U.Z,{staticClass:"avatar-bg-style",attrs:{size:"56"}},[t.joinReq.nickname.length<6?e(d.Z,{attrs:{"x-large":""}},[t._v(" mdi-help-circle-outline ")]):e(E.Z,{attrs:{src:t.pickedAvatar()},scopedSlots:t._u([{key:"placeholder",fn:function(){return[e(x.Z,{staticClass:"fill-height ma-0",attrs:{align:"center",justify:"center"}},[e(T.Z,{attrs:{indeterminate:"",color:"grey lighten-5"}})],1)]},proxy:!0}])})],1),e(U.Z,{staticClass:"avatar-bg-style",attrs:{size:"56"}},[e(m.Z,{attrs:{color:"grey-darken-4",large:"",elevation:"0",icon:""},on:{click:t.randomAvatar}},[e(d.Z,[t._v(" mdi-dice-5-outline ")])],1)],1)],1),e(_.Z,{staticClass:"d-flex justify-center",attrs:{cols:"12"}},[e(m.Z,{staticClass:"mt-n5",staticStyle:{border:"rgba(128,128,128,.3) 1px solid !important","background-color":"rgba(255,255,255,.3) !important"},attrs:{elevation:"2","x-large":""},on:{click:function(e){return t.joinRoom()}}},[e(d.Z,{staticClass:"mr-1"},[t._v(" mdi-plus ")]),t._v(" Join room ")],1)],1)],1)],1)],1)},Ut=[],$t={name:"ChatRoomJoin",mixins:[V],data:()=>({room:{id:0},joinReq:{nickname:"",avatar:null},gettersVuex:{isConnected:!1,chatId:""},nicknameRules:{minl:t=>t.length>=6||"Min 6 characters",maxl:t=>t.length<=14||"Max 6 characters"}}),created(){this.$store.dispatch("appSettingsModule/loadAppSettings"),this.getRoomInfo()},methods:{getRoomInfo(){this.axios.get(`/chat/${this.$route.params.roomId}/join`).then((t=>{t.data.available?this.room=t.data:(te.$emit("showAlert",{color:"warning",type:"warning",msg:`Room #${this.$route.params.roomId} is full. Try again later`}),this.$router.push("/"))})).catch((t=>{te.$emit("showAlert",{color:"error",type:"error",msg:t.response.data.message}),setTimeout((()=>this.$router.push("/")),1e3)}))},joinRoom(){this.axios.post(`/chat/${this.$route.params.roomId}/join`,this.joinReq).then((t=>{te.$emit("showAlert",{color:"success",type:"success",msg:`Welcome to room ${t.data.roomTopic}`}),this.$store.dispatch("userStorageModule/disconnectUser"),this.$store.dispatch("userStorageModule/setUserStorageAction",t.data),this.$router.push(`/chat/${this.$route.params.roomId}`)})).catch((t=>{te.$emit("showAlert",{color:"error",type:"error",msg:t.response.data.message})}))},pickedAvatar(){return this.joinReq.avatar||this.randomAvatar(),this.avatarURL(this.joinReq.avatar,this.joinReq.nickname)},randomAvatar(){this.joinReq.avatar=this.randomizeStyle(this.getAvailableAvatars,this.joinReq.avatar)}},computed:{...(0,D.Se)("appSettingsModule",["getAvailableAvatars"])}},jt=$t,Et=(0,y.Z)(jt,Mt,Ut,!1,null,null,null),Tt=Et.exports;a.ZP.use(I.ZP);const Nt=[{path:"/",name:"home",component:Y},{path:"/chat/:roomId",name:"chatroom",component:wt,meta:{requiresAuth:!0}},{path:"/chat/:roomId/join",name:"chatjoin",component:Tt,meta:{notInRoom:!0}}],Ot=new I.ZP({mode:"hash",routes:Nt});Ot.beforeEach((async(t,e,s)=>{const a=null!=localStorage.getItem("ACCESS_TOKEN"),o=localStorage.getItem("CHAT_ID"),r=o===t.params.roomId;t.meta.requiresAuth&&(a&&r||s(`/chat/${t.params.roomId}/join`)),t.meta.notInRoom&&a&&r&&s(`/chat/${t.params.roomId}`),s()}));var qt=Ot,Pt=s(6154);a.ZP.use(D.ZP);const Lt={namespaced:!0,state:{availableAvatars:[],roomCapacitySelect:[]},getters:{getAvailableAvatars:t=>t.availableAvatars,getRoomCapacitySelect:t=>t.roomCapacitySelect},mutations:{setSettings:(t,e)=>{const{availableAvatars:s,roomCapacitySelect:a}=e;t.availableAvatars=s,t.roomCapacitySelect=a}},actions:{loadAppSettings:t=>{let e={};Pt.Z.get("/chat/configuration").then((s=>{e=s.data,e.roomCapacitySelect=[];for(let t=2;t<=e.maxRoomCapacity;t++)e.roomCapacitySelect.push(t);t.commit("setSettings",e)}))}}};a.ZP.use(D.ZP);const Vt={namespaced:!0,getters:{getUserId:()=>localStorage.getItem("USER_ID"),getUserNickname:()=>localStorage.getItem("USER_NICKNAME"),getRoomTopic:()=>localStorage.getItem("ROOM_TOPIC"),getAccessToken:()=>localStorage.getItem("ACCESS_TOKEN"),getAvatarStyle:()=>localStorage.getItem("AVATAR_STYLE"),getChatId:()=>localStorage.getItem("CHAT_ID"),isUserConnected:()=>null!=localStorage.getItem("ACCESS_TOKEN")},mutations:{setUserStorage:(t,e)=>{localStorage.setItem("USER_ID",e.userId),localStorage.setItem("USER_NICKNAME",e.userNickname),localStorage.setItem("ROOM_TOPIC",e.roomTopic),localStorage.setItem("ACCESS_TOKEN",e.tokenPayload.accessToken),localStorage.setItem("AVATAR_STYLE",e.avatarStyle),localStorage.setItem("CHAT_ID",e.chatId)},clearUserStorage:()=>{localStorage.clear()}},actions:{setUserStorageAction:(t,e)=>{t.commit("setUserStorage",e)},disconnectUser:t=>{t.commit("clearUserStorage")}}};var Dt=s(8e3),zt=s.n(Dt),Bt=s(5016),Kt=s.n(Bt);const Wt=Object.freeze({MESSAGE:{type:"MESSAGE"},SPAM:{type:"SPAM"},JOIN:{type:"JOIN"},LEAVE:{type:"LEAVE"},KICK:{type:"KICK"},BAN:{type:"BAN"},DELETE:{type:"DELETE"}});var Jt=Wt;const Ht={baseUrl:"http://144.24.170.24:9876/v1"};a.ZP.use(D.ZP);const Gt={namespaced:!0,state:{socketURL:`${Ht.baseUrl}/websocket`,connected:!1,stomp:null,roomId:null,senderId:null,senderName:null,chatRoom:{users:[],activity:{messages:[],actions:[],spam:[]}}},getters:{getWsConnected:t=>t.connected,getMessages:t=>t.chatRoom.activity.messages,getActions:t=>t.chatRoom.activity.actions,getSpam:t=>t.chatRoom.activity.spam,getUsers:t=>t.chatRoom.users,getUserById:t=>e=>t.chatRoom.users.find((t=>t.id===e))},mutations:{setWsConnected:(t,e)=>{t.connected=e},setStompClient:(t,e)=>{t.stomp=e},setRoomId:(t,e)=>{t.roomId=e},setSenderId:(t,e)=>{t.senderId=e},setSenderName:(t,e)=>{t.senderName=e},setUsers:(t,e)=>{t.chatRoom.users=e},setMessageActivity:(t,e)=>{t.chatRoom.activity.messages.push(e)},setActionActivity:(t,e)=>{t.chatRoom.activity.actions.push(e)},setSpamActivity:(t,e)=>{t.chatRoom.activity.spam.push(e)}},actions:{filterActivity:(t,e)=>{console.log(e);const s=e.messageType===Jt.LEAVE.type;switch(e.messageType){case Jt.MESSAGE.type:t.commit("setMessageActivity",e);break;case Jt.LEAVE.type:case Jt.JOIN.type:t.dispatch("loadUsers"),te.$emit("showAlert",{color:s?"warning":"success",type:s?"warning":"success",msg:e.message});break;case Jt.SPAM.type:te.$emit("showAlert",{color:"warning",type:"warning",msg:e.message}),t.commit("setSpamActivity",e);break;default:t.commit("setActionActivity",e);break}},subscribeToChatRoom:(t,e)=>{t.state.stomp.subscribe(`/topic/messages/${e}`,(e=>{t.dispatch("filterActivity",JSON.parse(e.body))}))},connectWS:(t,e)=>{const{senderId:s,senderName:a,roomId:o}=e;if((!t.state.connected||!t.state.stomp)&&s&&a&&o){const r=new(zt())(t.state.socketURL,null,{sessionId:()=>o+":"+s+":"+a+":"+Date.now()}),n=Kt().over(r);n.debug=()=>{},n.connect(e,(()=>{t.commit("setRoomId",o),t.commit("setSenderId",s),t.commit("setSenderName",a),t.commit("setStompClient",n),t.commit("setWsConnected",!0),t.dispatch("subscribeToChatRoom",o),t.dispatch("loadUsers",o,s)}),(t=>{console.error("ERROR EN STOMPCLIENT"),console.error(t)}))}},sendMessage:(t,e)=>{t.state.stomp.send(`/ws/chat/${t.state.roomId}`,JSON.stringify({roomId:t.state.roomId,userId:t.state.senderId,senderNickname:t.state.senderName,message:e}),"")},setUsers:(t,e)=>{t.commit("setUsers",e)},loadUsers:t=>{Pt.Z.get(`/chat/${t.state.roomId}/users`).then((e=>{t.state.chatRoom.users=[],e.data.inscribedUsers.forEach((e=>{e.id===t.state.senderId&&(e.connected=!0),t.state.chatRoom.users.push(e)}))})).catch((t=>console.log(t)))}}};a.ZP.use(D.ZP);var Yt=new D.ZP.Store({modules:{appSettingsModule:Lt,userStorageModule:Vt,webSocketModule:Gt}}),Ft=s(2250);a.ZP.use(Ft.Z);var Qt=new Ft.Z({}),Xt=s(2346);a.ZP.use(Xt.Z,Pt.Z),a.ZP.config.productionTip=!1;const te=new a.ZP;Pt.Z.defaults.baseURL=Ht.baseUrl,a.ZP.config.productionTip=!1,Pt.Z.interceptors.request.use((async t=>{const e=localStorage.getItem("ACCESS_TOKEN");return e&&(t.headers.Authorization=`Bearer ${e}`),t.headers.Accept="application/json",t}),(t=>Promise.reject(t))),new a.ZP({router:qt,store:Yt,vuetify:Qt,render:t=>t(b)}).$mount("#app")}},e={};function s(a){var o=e[a];if(void 0!==o)return o.exports;var r=e[a]={id:a,loaded:!1,exports:{}};return t[a].call(r.exports,r,r.exports,s),r.loaded=!0,r.exports}s.m=t,function(){s.amdO={}}(),function(){var t=[];s.O=function(e,a,o,r){if(!a){var n=1/0;for(m=0;m<t.length;m++){a=t[m][0],o=t[m][1],r=t[m][2];for(var i=!0,c=0;c<a.length;c++)(!1&r||n>=r)&&Object.keys(s.O).every((function(t){return s.O[t](a[c])}))?a.splice(c--,1):(i=!1,r<n&&(n=r));if(i){t.splice(m--,1);var l=o();void 0!==l&&(e=l)}}return e}r=r||0;for(var m=t.length;m>0&&t[m-1][2]>r;m--)t[m]=t[m-1];t[m]=[a,o,r]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var a in e)s.o(e,a)&&!s.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.hmd=function(t){return t=Object.create(t),t.children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t}}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={143:0};s.O.j=function(e){return 0===t[e]};var e=function(e,a){var o,r,n=a[0],i=a[1],c=a[2],l=0;if(n.some((function(e){return 0!==t[e]}))){for(o in i)s.o(i,o)&&(s.m[o]=i[o]);if(c)var m=c(s)}for(e&&e(a);l<n.length;l++)r=n[l],s.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return s.O(m)},a=self["webpackChunkwschat"]=self["webpackChunkwschat"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=s.O(void 0,[998],(function(){return s(5825)}));a=s.O(a)})();
//# sourceMappingURL=app.51947d2c.js.map